<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Homepage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="javascript" href="homepagefunctions.js" type="script" media="screen"/>
</head>

<body class="homepage">

<!--CHATBOT-->
<div id="weatherwisebot">
    <div id="weatherwiseicon">
        <img src ="Images/Alt lOGO.png" id="AILOGO" />
    </div>
    <div id="weatherwisecontainer" class="hidden">
        <div id="weatherwiseheader">
            <span>ChatBot</span>
            <button id="closebtn">&times;</button>
        </div>
        <div id="weatherwisebody">
            <div id="weatherwisemessages">
                
            </div>
        </div>
        <div id="prompts">
            <button class="promptbtn">How's the weather today?</button>
            <button class="promptbtn">What is the average temperature today?</button>
            <button class="promptbtn">Is it going to rain between 3 & 6 today?</button>
            <button class="promptbtn">Are flights on schedule today?</button>
            <button class="promptbtn">Is it safe to go do my shopping today?</button>
        </div>
        <div id="weatherwiseinputcontainer">
            <input type="text" id="weatherwiseinput" placeholder="Type a message...."/>
            <button id="sendbtn">Send</button> 
        </div>
    </div>
</div>

<script src="chatbot.js"></script>

  
  <!-- header -->
  <header class="top-header">
    <button class="header-icon" aria-label="Open menu">â˜°</button>

    <div class="header-logo">
      <img src="logoexample5.png" alt="MMSD logo" />
    </div>

    <button class="header-icon" aria-label="Account">ğŸ‘¤</button>
  </header>

  <!-- warning -->
  <div class="warning-bar">
    <div class="warning-bar-left">
      <span class="warning-icon">âš ï¸</span>
      <span class="warning-text">Rain Warning: Status Yellow</span>
      <span class="warning-chevron">â€º</span>
    </div>
    <button class="warning-settings" aria-label="Warning settings">âš™ï¸</button>
  </div>


<script>

    function getLocation() 
    {
    navigator.geolocation.getCurrentPosition( showCoords );
    }


    function showCoords (position) {

            
            var devLatitude = position.coords.latitude;
            var devLongitude = position.coords.longitude;
            
            document.getElementById("current_coords").innerHTML = "lat: " + devLatitude + " long: " + devLongitude;
    }  


    window.addEventListener("load", init);

    function init()
    {	
    document.getElementById("get_coords_but").addEventListener("click", getLocation)		
    }

</script>

  <!--side bar-->
  <div id="sidebar">
        <p><input type = "button" value = "Find my location" id = "get_coords_but" >
              <div id = "current_coords"></div>
        </p>
        <p><button id="profile_sidebar" value="get_profile" onclick="open_profile()">Profile</button>
        </p>
        <p><button id="settings_sidebar" value="get_settings" onclick="open_settings()">Settings</button>
        </p>
        <p><button id="logout_sidebar" value="logout" onclick="logout()">Log Out</button>
        </p>

  </div>

  <main class="home-shell">

    <!-- today and tomorrow -->
    <section class="top-section">

      <div class="top-left">
        <div class="today-header">
          <div>
            <div class="today-label">Today</div>
            <div class="today-date" id="today-date">Loading...</div>
          </div>
          <div class="today-location-row">
            <span class="location-icon">ğŸ“</span>
            <span class="location-name">Cork City, Cork</span>
          </div>
        </div>

        <!-- Search not set up tho -->
        <div class="search-row">
          <input
            class="location-search"
            type="text"
            placeholder="Search location..."
          />
          <button class="search-clear" aria-label="Clear search">Ã—</button>
        </div>
        

        <div class="card card-weather">
          <div class="card-weather-main">
            <div class="temp-block">
              <div class="temp-main" id="current-temp">--Â°</div>
              <div class="temp-feels" id="current-feels">Feels like --Â°</div>
            </div>

            <div class="icon-block">
              <div class="icon-item">
                <div class="icon-symbol" id="current-icon">â˜ï¸</div>
                <div class="icon-label" id="current-condition">Loading...</div>
              </div>

              <div class="icon-item">
                <div class="icon-symbol">ğŸŒ’</div>
                <div class="icon-label">Moon Phase</div>
              </div>
            </div>
          </div>

          <div class="card-weather-details">
            <div class="detail-column">
              <div class="detail-row">
                <span class="detail-icon">ğŸ’§</span>
                <span id="current-rain">Rain -- mm</span>
              </div>
              <div class="detail-row">
                <span class="detail-icon">ğŸ’¨</span>
                <span id="current-wind">Wind -- km/h</span>
              </div>
              <div class="detail-row">
                <span class="detail-icon">ğŸŒ¬ï¸</span>
                <span id="current-gust">Gust -- km/h</span>
              </div>
            </div>

            <div class="detail-column">
              <div class="detail-row">
                <span class="detail-icon">ğŸŒ…</span>
                <span id="sunrise">Sunrise --:--</span>
              </div>
              <div class="detail-row">
                <span class="detail-icon">ğŸŒ‡</span>
                <span id="sunset">Sunset --:--</span>
              </div>
              <div class="detail-row">
                <span class="detail-icon">â˜€ï¸</span>
                <span id="uv-index">UV --</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="top-right">

        <div class="card kinsale-graphic">
          <img src="old head of kinsale.png" alt="Old Head of Kinsale" />
        </div>

        <div class="card card-tomorrow">
          <div class="tomorrow-header">
            <div class="tomorrow-title">Tomorrow</div>
            <div class="tomorrow-date" id="tomorrow-date">Loading...</div>
          </div>

          <div class="tomorrow-main">
            <div class="tomorrow-temp-block">
              <div class="temp-main" id="tomorrow-temp">--Â°</div>
              <div class="temp-minmax" id="tomorrow-minmax">--Â°</div>
            </div>

            <div class="tomorrow-conditions" id="tomorrow-conditions">
              <div>Loading...</div>
            </div>
          </div>

          <div class="tomorrow-badge">
            <span>ğŸ°</span>
          </div>
        </div>
      </div>

    </section>

    <!-- 7 days and widgets -->
    <section class="forecast-row">

      <div class="card card-7day">
        <div class="card-heading">7-Day Forecast</div>
        <div class="forecast-strip">

          <!-- Example day not linked to api -->
          <div class="forecast-day hover-card">
            <div class="forecast-day-label">Mon</div>
            <div class="forecast-icon">â˜ï¸</div>
            <div class="forecast-temp">12Â°</div>
            <div class="forecast-rain">ğŸ’§ 20</div>
            <div class="forecast-wind">ğŸŒ¬ï¸ 16km</div>
          </div>

        </div>
      </div>

      <div class="card card-farming hover-card">
        <div class="farming-icon">ğŸŒ±</div>
        <div class="farming-label">Farming</div>
      </div>

    </section>

    <!-- widgets -->
    <section class="bottom-widgets">
      <div class="card bottom-card hover-card">
        <div class="bottom-icon">âš“</div>
        <div class="bottom-label">Marine</div>
      </div>

      <div class="card bottom-card hover-card">
        <div class="bottom-icon">â•</div>
        <div class="bottom-label">Health</div>
      </div>

      <div class="card bottom-card hover-card">
        <div class="bottom-icon">ğŸ“…</div>
        <div class="bottom-label">Outdoor Planner</div>
      </div>
    </section>

  </main>

  <script>
    
    function processWeather(data) {
      console.log("Weather received:", data);

      
      var max = data.daily.temperature_2m_max;
      var min = data.daily.temperature_2m_min;
      var codes = data.daily.weather_code;
      var times = data.daily.time;

      
      var todayMax = Math.round(max[0]);
      var todayMin = Math.round(min[0]);
      var todayCode = codes[0];

      document.getElementById("current-temp").textContent = todayMax + "Â°";
      document.getElementById("current-feels").textContent =
        "Feels like " + todayMin + "Â°";

      document.getElementById("today-date").textContent = times[0];

      
      var conditionMap = {
        0: "Clear Sky",
        1: "Mainly Clear",
        2: "Partly Cloudy",
        3: "Cloudy",
        51: "Drizzle",
        61: "Rain",
        71: "Snow",
        95: "Thunderstorm"
      };

      var iconMap = {
        0: "â˜€ï¸",
        1: "ğŸŒ¤ï¸",
        2: "â›…",
        3: "â˜ï¸",
        51: "ğŸŒ¦ï¸",
        61: "ğŸŒ§ï¸",
        71: "â„ï¸",
        95: "â›ˆï¸"
      };

      document.getElementById("current-condition").textContent =
        conditionMap[todayCode] || "Weather";
      document.getElementById("current-icon").textContent =
        iconMap[todayCode] || "â›…";

   
      var tomorrowMax = Math.round(max[1]);
      var tomorrowMin = Math.round(min[1]);
      var tomorrowCode = codes[1];

      document.getElementById("tomorrow-temp").textContent =
        tomorrowMax + "Â°";
      document.getElementById("tomorrow-minmax").textContent =
        tomorrowMin + "Â°";

      document.getElementById("tomorrow-date").textContent = times[1];

      document.getElementById("tomorrow-conditions").innerHTML =
        (conditionMap[tomorrowCode] || "Weather") +
        "<br>ğŸ’§ Rain<br>ğŸ’¨ Wind";
    }
    
   // coordinates for cork city 
    function fetchWeather() {
      
    

      var lat = 51.8985;
      var lon = -8.4756;

      
      var query =
        "latitude=" + lat +
        "&longitude=" + lon +
        "&daily=weather_code,temperature_2m_max,temperature_2m_min" +
        "&timezone=auto";

      
      var url = "https://webdevcit.com/notes/getweather.php?" + query;

      
      var script = document.createElement("script");
      script.src = url;
      document.body.appendChild(script);
    }

    // run when the page refresh
    fetchWeather();
  </script>

</body>
</html>
